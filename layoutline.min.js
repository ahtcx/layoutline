window.Layoutline=function(i,t){return i&&t?window===this?new window.Layoutline(i,t):(this.delay=t,this.layouts=i,this.before=0,this.chain=0,this.chains=[],this.precision=[],this):void 0},window.Layoutline.prototype={getPredictedLayout:function(){var i=this.getPrecision();return this.layouts[i.indexOf(Math.max.apply(Math,i))]},getPosition:function(i,t,o){for(row in t)for(cha in t[row])if(t[row][cha]===i)return[parseFloat(cha)+o[row],parseFloat(row)];return null},getPrecision:function(){var i=[];for(p in this.precision)for(layout in this.layouts)i.length<=layout&&i.push(void 0),null===this.precision[p][layout]&&(i[layout]=null),null!==i[layout]&&(void 0===i[layout]&&(i[layout]=this.precision[p][layout]),i[layout]=(i[layout]+this.precision[p][layout])/2);return i},keyPressed:function(i,t){var o=Date.now();o-t.before<=t.delay?t.chains[t.chain-1].push(i):(t.chains.push([i]),t.chain+=1),t.updatePrecision(t.chains[t.chain-1],t.chains.length-1),t.before=o},updatePrecision:function(i,t){this.precision.length<=t&&this.precision.push([]);for(layout in this.layouts)if(this.precision[t].length<=layout&&this.precision[t].push(void 0),i.length>1){var o=this.layouts[layout].layout,n=this.layouts[layout].offsets,s=this.getPosition(i[i.length-2],o,n),a=this.getPosition(i[i.length-1],o,n);if(s&&a){var e=Math.sqrt(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2));void 0===this.precision[t][layout]&&(this.precision[t][layout]=1/e),this.precision[t][layout]=(this.precision[t][layout]+1/e)/2}else this.precision[t][layout]=null}}};
